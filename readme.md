# Тестовое задание "Упрвление турникетами в метро"

Включает компоненты:

- **TourniquetEntryConfigurations** - класс для задания конфигурации проходов. На аднный момент в конфигурации задается лишь строковый идентификатор турникета и стоимость его открытия.
- **TourniquetHardwareApi** - класс, реализующий связь с железом
- **TourniquetEntry** - класс для управления туникетом. Читает коннфигурацию и отправляет железу команды на открытие-закрытие
- **TourniquetUserAccountTrait** - методы для класса пользователя, отвечающие за валидацию пользователя и аботу с балансом.
- **TourniquetService** - сервис, общающийся с TourniquetEntry.

Для работы нужно создать конфигурацию. Текущая тестовая конфигурация включает в себя три прохода (можно посмотреть в TourniquetEntryConfigurations) со следующими ID:
- 'one-side-entry'
- 'two-sided-entrance'
- 'two-sided-exit'

Первые два турникета требуют для открытия прохода 30 рублей, последний бесплатен.

Также в тестовом репозитории UserAccountRepository есть 3 пользователя с ID 1,2,3 с разным балансом.

```php
$service = new TourniquetService();

/** Открыть проход и снять с пользователя денег */
$service->openEntry($entryId, $accountId);

/** Закрыть проход. Предполагается, что эту команду отправляет датчик */
$service->closeEntry($entryId);

/** проверить, открыт ли проход. */
$service->isEntryOpened($entryId);
```
Методы принимают ID прохода и ID аккаунта пользователя.

Также а папке app вложен небольшой bootstrap, позволяющий подключать контейнер с сервисом

```php
$container = require 'app/bootstrap.php';
$service = $container->get('tservice');
```